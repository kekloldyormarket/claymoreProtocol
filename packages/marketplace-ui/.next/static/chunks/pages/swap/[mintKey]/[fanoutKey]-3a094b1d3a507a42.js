(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{34711:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/swap/[mintKey]/[fanoutKey]",function(){return t(89829)}])},89829:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return j},numberWithCommas:function(){return K},SwapDisplay:function(){return C}});var r=t(92021),o=t.n(r),i=t(52322),u=t(86334),a=t(2784),s=t(6388),c=t(28392),l=t(31186),p=t(27158),f=t(60564),d=t(69704),h=t(725),x=t(20893),m=t(5632),y=t(60163),b=t(62981);function v(e,n,t,r,o,i,u){try{var a=e[i](u),s=a.value}catch(c){return void t(c)}a.done?n(s):Promise.resolve(s).then(r,o)}function w(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function u(e){v(i,r,o,u,a,"next",e)}function a(e){v(i,r,o,u,a,"throw",e)}u(void 0)}))}}function g(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(t.push(u.value),!n||t.length!==n);r=!0);}catch(s){o=!0,i=s}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function k(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});function S(e){if(e)return e.toNumber()/Math.pow(10,6)}var j=!0;function K(e,n){var t=void 0===n?4:n;return(0,l.roundToDecimals)(e,t).toLocaleString("en-US")}var C=function(e){var n=e.name,t=e.image,r=e.description,v=(0,m.useRouter)();console.log(v);var j=v.query,C=j.mintKey,M=j.fanoutKey;console.log(C);var _=(0,l.usePublicKey)(C),A=(0,l.useTokenBondingFromMint)(_),F=A.info,I=A.loading;console.log(F);var T=(0,l.usePublicKey)(M),N=(0,b.useWallet)(),E=(0,a.useState)("1.38"),B=E[0],P=E[1],z=(0,a.useState)(0),D=(z[0],z[1],g(a.useState(0),2)),O=(D[0],D[1]),W=g(a.useState(0),2),L=W[0],U=W[1],X=g(a.useState(0),2),q=(X[0],X[1]),G=(0,a.useState)(0),H=G[0],R=G[1];function Y(){return(Y=w(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),console.log(n.target.value),P(n.target.value);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=w(o().mark((function e(){var n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=11;break}return n=new s.FanoutClient(new p.Connection("https://ssc-dao.genesysgo.net/"),N),e.next=5,n.distributeTokenMemberInstructions({distributeForMint:!1,fanout:T,membershipMint:_,member:N.publicKey,payer:N.publicKey});case 5:return t=e.sent,e.next=8,n.distributeTokenMemberInstructions({distributeForMint:!0,fanoutMint:_,fanout:T,membershipMint:_,member:N.publicKey,payer:N.publicKey});case 8:return e.sent,e.next=11,n.sendInstructions(k(t.instructions),[],N.publicKey);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=w(o().mark((function e(){var n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=10;break}return n=new s.FanoutClient(new p.Connection("https://ssc-dao.genesysgo.net/"),N),console.log(parseFloat(B)*Math.pow(10,6)),e.next=6,n.stakeTokenMemberInstructions({shares:parseFloat(B)*Math.pow(10,6),fanout:T,membershipMint:_,member:N.publicKey,payer:N.publicKey});case 6:return t=e.sent,e.next=9,n.sendInstructions(t.instructions,[],N.publicKey);case 9:e.sent;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){return(Q=w(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=5;break}return n=new s.FanoutClient(new p.Connection("https://ssc-dao.genesysgo.net/"),N),e.next=5,n.unstakeTokenMember({fanout:T,member:N.publicKey,payer:N.publicKey});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return T&&setTimeout(function(){var e=w(o().mark((function e(){var n,t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I){e.next=25;break}return e.prev=1,n=new s.FanoutClient(new p.Connection("https://ssc-dao.genesysgo.net/"),N),e.next=5,n.fetch(T,s.Fanout);case 5:return t=e.sent,console.log(t),console.log(t),q(S(new c.BN(null===t||void 0===t?void 0:t.totalShares))),U(S(new c.BN(null===t||void 0===t?void 0:t.totalStakedShares))),O(new c.BN(null===t||void 0===t?void 0:t.totalMembers)),e.prev=11,e.next=14,getAssociatedAccountBalance(connection2,N.publicKey,_);case 14:r=e.sent,R(r.uiAmount),e.next=20;break;case 18:e.prev=18,e.t0=e.catch(11);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(1),console.log(e.t1);case 25:case"end":return e.stop()}}),e,null,[[1,22],[11,18]])})));return function(){return e.apply(this,arguments)}}(),10*Math.random()*1e3*1.38),(0,i.jsxs)(f.xu,{w:"full",backgroundColor:"#f9f9f9",height:"100vh",overflow:"auto",paddingBottom:"200px",children:[(0,i.jsx)(u.y,{title:"Strata Swap | ".concat(n),description:r,image:t,url:"".concat(y._O,"/bounty/").concat(_,"/")}),(0,i.jsx)(f.xu,{padding:"54px",backgroundColor:"black.500"}),(0,i.jsxs)(f.W2,{mt:"-72px",justify:"stretch",maxW:"460px",children:[(0,i.jsx)(f.X6,{mb:2,color:"white",fontSize:"24px",fontWeight:600,children:"Swap"}),(0,i.jsxs)(f.xu,{zIndex:1,bg:"white",shadow:"xl",rounded:"lg",minH:"400px",children:[I&&(0,i.jsx)(f.M5,{children:(0,i.jsx)(d.$,{})}),!I&&F&&(0,i.jsxs)("div",{children:[(0,i.jsx)(f.Kq,{direction:["column","row"],children:(0,i.jsxs)(f.Ug,{flexGrow:4,children:[L&&(0,i.jsx)(f.xv,{children:(0,i.jsxs)(f.xu,{w:"full",position:"relative",children:[K(L,4)," Staked "]})}),H&&(0,i.jsxs)(f.xv,{children:[(0,i.jsxs)(f.xu,{w:"full",position:"relative",children:[K(H,4)," "]})," Your Balance"]})]})}),(0,i.jsxs)(f.gC,{children:[(0,i.jsx)(h.zx,{onClick:function(){return $.apply(this,arguments)},children:"meCLAIM"}),(0,i.jsx)(x.II,{style:{color:"black",fontSize:"30px;",backgroundColor:"grey"},type:"text",onInput:function(e){return Y.apply(this,arguments)},value:B}),(0,i.jsx)(h.zx,{onClick:function(){return J.apply(this,arguments)},children:"STAKEme"}),(0,i.jsx)(h.zx,{onClick:function(){return Q.apply(this,arguments)},children:"UNSTAKEALLme"})]}),(0,i.jsx)(l.Swap,{tokenBondingKey:F.publicKey})]})]})]})]})};n.default=C}},function(e){e.O(0,[774,888,179],(function(){return n=34711,e(e.s=n);var n}));var n=e.O();_N_E=n}]);